!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Stepper=e()}(this,(function(){"use strict";var t=function(e,s){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])})(e,s)};var e,s=function(){return(s=Object.assign||function(t){for(var e,s=1,r=arguments.length;s<r;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},r={startIndex:0,className:{progressContainer:"stepper-progress",progressItem:"stepper-progress-item",progressActive:"is-active",stepsContainer:"stepper",stepItem:"stepper-item",stepActive:"is-active"}};!function(t){t.beforeSetup="stepper.before.setup",t.afterSetup="stepper.after.setup",t.beforeDestroy="stepper.before.destroy",t.afterDestroy="stepper.after.destroy",t.beforeReset="stepper.before.reset",t.afterReset="stepper.after.reset",t.beforeChange="stepper.before.change",t.afterChange="stepper.after.change"}(e||(e={}));var n=e;function i(t,e){void 0===e&&(e={});var s=t instanceof Element;if(!s&&"string"!=typeof t)throw new Error(t+" is invalid value of tag");var r=s?t:document.createElement(t);if(e.children&&Array.isArray(e.children))for(var n=e.children.reverse();n.length;){var i=n.pop();i instanceof Element&&r.appendChild(i)}if(e.attr&&"object"==typeof e.attr)for(var o in e.attr)r.setAttribute(o,e.attr[o]);return r}var o=function(){function t(t,e,s){this.className=e,this.opts=null!=s?s:{},this.container=this.setupContainer(this.opts.container),this.progressItems=this.setupItems(t,this.container)}return t.prototype.getHTML=function(){return this.container},t.prototype.setActive=function(t){if(this.progressItems[t]){for(var e=void 0!==this.currentIndex&&(this.currentIndex-1===t||this.currentIndex+1===t),s=t<=0||!e&&!this.isPrevItemActive(t)?0:t;s<=this.progressItems.length-1;){var r=this.progressItems[s];if(s<=t&&r.classList.add(this.className.progressActive),s>t&&r.classList.remove(this.className.progressActive),e&&!this.isNextItemActive(s))break;s++}this.currentIndex=t}},t.prototype.getOpts=function(){return this.opts},t.prototype.isPrevItemActive=function(t){var e=t-1;return e>=0&&this.progressItems[e].classList.contains(this.className.progressActive)},t.prototype.isNextItemActive=function(t){var e=t+1;return e<=this.progressItems.length-1&&this.progressItems[e].classList.contains(this.className.progressActive)},t.prototype.setupContainer=function(t){return t?(t.classList.add(this.className.progressContainer),t):i("div",{attr:{class:this.className.progressContainer}})},t.prototype.setupItems=function(t,e){for(var s=this,r=[],n=function(){var t=i("div",{attr:{class:o.className.progressItem}}),n=r.length+1;t.textContent=n.toString(),o.opts.clickHandler&&t.addEventListener("click",(function(t){s.opts.clickHandler&&s.opts.clickHandler(n-1)})),r.push(t),e.appendChild(t)},o=this;r.length!==t;)n();return r},t}(),p=function(e){function s(t,s){var r=e.call(this,t.children,s.index)||this;return r.opts=s,r.container=t,s.progress&&(r.progress=r.setupProgress()),r.setup(r.getStepsHtml()),r}return function(e,s){function r(){this.constructor=e}t(e,s),e.prototype=null===s?Object.create(s):(r.prototype=s.prototype,new r)}(s,e),s.prototype.setStepActive=function(t){if(isFinite(t)){var e=this.setStep(t),s=e[0],r=e[1];this.setStepClassActive(s,r),this.progress&&r&&this.progress.setActive(r.index)}},s.prototype.getHTML=function(){return this.container},s.prototype.getProgress=function(){return this.progress},s.prototype.setStepClassActive=function(t,e){t&&t.elem.classList.remove(this.opts.className.stepActive),e&&e.elem.classList.add(this.opts.className.stepActive)},s.prototype.setupProgress=function(){var t,e=new o(this.getStepsCount(),this.opts.className,this.opts.progress);return(null===(t=this.opts.progress)||void 0===t?void 0:t.container)||this.container.insertAdjacentElement("beforebegin",e.getHTML()),e},s.prototype.setup=function(t){var e=this;this.container.classList.add(this.opts.className.stepsContainer),Array.prototype.forEach.call(t,(function(t){t.classList.add(e.opts.className.stepItem),t.classList.remove(e.opts.className.stepActive)})),this.setStepClassActive(void 0,this.getCurrentStep()),this.progress&&this.progress.setActive(this.opts.index)},s}(function(){function t(t,e){void 0===e&&(e=0),this.steps=t,this.currentStep={index:e,elem:this.steps[e]}}return t.prototype.getStepsCount=function(){return this.steps.length},t.prototype.getStepsHtml=function(){return this.steps},t.prototype.getCurrentStep=function(){return this.currentStep},t.prototype.getStep=function(t){if(this.isStepIndexValid(t)){var e=this.steps[t];if(e)return{index:t,elem:e}}},t.prototype.setStep=function(t){return this.isStepIndexValid(t)&&this.isStepInRange(t)?(this.prevStep=this.currentStep,this.currentStep={index:t,elem:this.steps[t]},[this.prevStep,this.currentStep]):[]},t.prototype.isStepIndexValid=function(t){var e="number"==typeof t&&isFinite(t);return e||console.warn("[Stepper.js] supplied step value is not a number"),e},t.prototype.isStepInRange=function(t){var e=t>=0&&t<=this.getStepsCount()-1;return e||console.warn("[Stepper.js] cannot perform step change to index: "+t),e},t}());function a(t,e,s){var r=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:s});t.dispatchEvent(r)}return function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var s=document.createEvent("CustomEvent");return s.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),s}}(),function(){function t(t,e){this.cacheId="stepper_data",this.eventListenters={change:[]},this.setup(t,e)}return t.prototype.prev=function(){this.performStepChange(this.stepperView.getCurrentStep().index-1)},t.prototype.next=function(){this.performStepChange(this.stepperView.getCurrentStep().index+1)},t.prototype.stepTo=function(t){this.performStepChange(t)},t.prototype.getCurrentStep=function(){return this.state.step},t.prototype.freeze=function(t){this.setState(s(s({},this.state),{isFrozen:t}))},t.prototype.isFrozen=function(){return this.state.isFrozen},t.prototype.setup=function(t,e){a(t,n.beforeSetup),this.options=s(s(s({},r),e),{className:s(s({},r.className),e.className)}),this.state=this.getInitialState(),this.stepperView=new p(t,this.composeStepperViewOpts(t.children.length,this.options,this.state)),this.onStateChange(this.handleStateChange.bind(this)),this.dispatchStepperEvent(n.afterSetup)},t.prototype.destroy=function(){for(var t in this.dispatchStepperEvent(n.beforeDestroy),this)"options"!==t&&delete this[t];for(var e=Object.getPrototypeOf(this);e;){for(var t in e)delete e[t];e=Object.getPrototypeOf(e)}this.dispatchStepperEvent(n.afterDestroy)},t.prototype.reset=function(){this.dispatchStepperEvent(n.beforeReset),this.performStepChange(0,!1),this.dispatchStepperEvent(n.afterReset)},t.prototype.handleStateChange=function(t,e){e.step&&this.stepperView.setStepActive(e.step.index),this.dispatchStepperEvent(n.afterChange,{currentStep:e.step})},t.prototype.onStateChange=function(t){this.eventListenters.change.push(t)},t.prototype.performStepChange=function(t,e){void 0===e&&(e=!0),t=parseInt(t);var r=this.stepperView.getCurrentStep(),i=this.stepperView.getStep(t);if(!i)return!1;this.dispatchStepperEvent(n.beforeChange,{currentStep:r,nextStep:i});var o=!0;return e&&(o=this.canPerformStepChange(r,i)),!!o&&(this.setState(s(s({},this.state),{step:i})),o)},t.prototype.canPerformStepChange=function(t,e){if(this.state.isFrozen)return console.warn("[Stepper.js] is frozen"),!1;if(!this.options.validateStepChange||"function"!=typeof this.options.validateStepChange)return!0;var s=this.options.validateStepChange(t,e);return s||console.warn("[Stepper.js]: step change did not pass validateStepChange()"),s},t.prototype.getInitialState=function(){if(this.options.cache&&localStorage)try{var t=localStorage.getItem(this.cacheId);if(t){var e=JSON.parse(t);if(e&&this.isStateValid(e))return e}}catch(t){console.warn("[Stepper.js] failed to parse cached state. Using default")}return{isFrozen:!1}},t.prototype.composeStepperViewOpts=function(t,e,r){var n=this,i=function(){var s=r.step?r.step.index:e.startIndex;if(e.urlParam){var n="string"==typeof e.urlParam?e.urlParam:"step",i=function(){var t=window.location.search.split("&").filter((function(t){return-1!==t.indexOf(n+"=")}));if(1===t.length){var e=parseInt(t[0].split("=")[1]);if("number"==typeof e&&e>=0)return e}}();"number"!=typeof i?console.warn("[Stepper.js] supplied urlParam is not valid"):i>t-1||i<0?console.warn("[Stepper.js] supplied urlParam '"+n+"=' is not in range."):s=i}return s}(),o="object"==typeof e.progress&&e.progress.navEnabled?s(s({},e.progress),{clickHandler:function(t){n.performStepChange(t)}}):e.progress;return{index:i,className:e.className,progress:o}},t.prototype.setState=function(t){var e=this.state;this.eventListenters.change.forEach((function(s){return setTimeout((function(){return s(e,t)}),0)})),this.state=t,this.options.cache&&this.saveState(this.state)},t.prototype.saveState=function(t){var e=this;if(localStorage){var s=function(t,e){if("elem"!==t)return e};setTimeout((function(){return localStorage.setItem(e.cacheId,JSON.stringify(t,s))}),0)}},t.prototype.isStateValid=function(t){return"object"==typeof t.step&&isFinite(t.step.index)},t.prototype.dispatchStepperEvent=function(t,e){a(this.stepperView.getHTML(),t,e)},t.prototype.validateArgs=function(){},t.prototype.isOptsValid=function(){},t.prototype.isContainerValid=function(){},t.prototype.logError=function(){},t}()}));
